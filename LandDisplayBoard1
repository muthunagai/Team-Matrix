Public Class Lane1


    Private Sub Lane1_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        ' Dim dbLotName As String
        refresh_lane_data()

    End Sub
    Public Sub refresh_lane_data()

        Dim i As Integer
        ' Using connObj As New SqlClient.SqlConnection("Data Source= .\SQLExpress;AttachDbFilename=C:\Users\Muthunagai\Documents\SQL Server Management Studio\LotStatus.mdf;Integrated Security=True;User Instance=True")
        'Using cmdObj As New SqlClient.SqlCommand("select LotID, LotStatus from LotDetails where LotID = 2", connObj)
        Using connObj As New SqlClient.SqlConnection("Data Source=localhost;Initial Catalog = Lotstatus;Integrated Security=SSPI")
            'Provider=SQLOLEDB;Data Source=serverName;"Initial Catalog = databaseName;User ID = MyUserID;"  .\SQLExpress

            Using cmdObj As New SqlClient.SqlCommand("Select [Lotstatus], [LotID] from [Lotstatus].[dbo].[LotDetails];", connObj)

                connObj.Open()
                Using readerObj As SqlClient.SqlDataReader = cmdObj.ExecuteReader
                    i = 1
                    Do While readerObj.Read()
                        ' Console.WriteLine("textbox" & i)
                        Dim name As String = "TextBox" + System.Convert.ToString(i)


                        Dim lotTtext As TextBox = CType(Me.Controls(name), TextBox)
                        If (lotTtext IsNot Nothing) Then

                            If readerObj("Lotstatus") = False Then
                                lotTtext.BackColor = Color.Green
                            Else
                                lotTtext.BackColor = Color.Red
                            End If
                        End If

                        i += 1
                    Loop
                    'Console.WriteLine("textbox" + i)
                End Using
                connObj.Close()
            End Using
        End Using

    End Sub


End Class
